$(function(){function e(){c&&c.destroy&&c.destroy();c=$.Jcrop("#imcrop");h();c.disable()}function h(){var a=parseInt($("#imcrop_wrap").height()),b=parseInt($("#imcrop_wrap").width()),d=(100-f)/2;c.setSelect([Math.round(b/100*d),Math.round(a/100*d),b-Math.round(b/100*d),a-Math.round(a/100*d)])}function g(){$.get("./viewlist.php",{},function(a){$("#list").html($(a))},"html")}var c,f=100,i=$("#imcrop").attr("src");$.ajaxSetup({cache:false});e();(function(){var a=$("#imcrop").width(),b=$("#imcrop").height();
$("#imcrop_wrap").css({position:"relative"}).width(a).height(b);$("#imcrop").css({position:"absolute"})})();g();$("#sldim").slider({min:10,max:100,step:5,value:100,slide:function(a,b){f=parseInt(b.value);h();$(this).next().html(f+"%")}});$("#slrot").slider({min:-180,max:180,step:10,value:0,slide:function(a,b){$("#imcrop").rotate(b.value,"abs");$(this).next().html(b.value+"&deg;");$("#log").text($("#imcrop").width());$("#imcrop").position({my:"center",at:"center",of:$("#imcrop_wrap")})},change:function(a,
b){var d=b.value;if(d==0){c&&c.destroy&&c.destroy();$("#imcrop").attr("src",i);e()}else $.get("./rotate.php",{filename:i,angle:d},function(j){var k=$("#imcrop_wrap").width(),l=$("#imcrop_wrap").height();$("#imcrop").attr("src",j).width(k).height(l);e()})}});$("#btsav").button().click(function(){var a=c.tellSelect();a.filename=$("#imcrop").attr("src");$("#thumbs").load("./crop.php?"+$.param(a),g)});$("#btlist").button().click(function(){g()})});
